#
# Input file for conduction case
#
nout = 1      # Number of output timesteps
timestep = 1  # Time between outputs

# Number of points in z
MZ = 16
zmin = 0.0
zmax = 1.0

#number of guard cells
MYG = 1
MXG = 1

[output]
floats = false #false -> output in doubles

[mesh]
ixseps1 = -1
ixseps2 = -1             # Set x location of separatrix 2

#nx = internals gridpoints + guardcells
nx = 16

#ny = internal gridpoints
ny = 16

Lx = 1.0
Ly = 1.0

dump_format = "nc"     # Write NetCDF format files

#grid points are distributed symmetrically
symmetricGlobalX = true
symmetricGlobalY = true

##################################################
[mesh:ddx]   # Methods used for perp (x) derivative terms

first = C2
second = C2
upwind = W3
flux = SPLIT

[mesh:ddy]   # Methods used for parallel (y) derivative terms

first = C2
second = C2
upwind = W3
flux = SPLIT

[mesh:ddz]   # Methods used for perp (z) derivative terms

first = C2
second = C2
upwind = W3
flux = SPLIT


[solver]

type = pvode

mms = true

atol = 1e-15 # absolute tolerance
rtol = 1e-07  # relative tolerance
mxstep = 1000000

[cyto]
Dx = 1
Dy = 1 # No Y conduction
Dz = 1 # No Z conduction

[all]
scale = 1.0

[N]

xl = x * mesh:Lx           # In the range [0,Lx]
yl = y * mesh:Ly / (2*pi)  # In the range [0,Ly]

solution = 0.9*N:xl + 0.2*sin(5.0*N:xl^2 - 2*z) + sin(7*N:yl + 1.234)*cos(N:yl)*cos(10*z) + 0.9

ddx = 2.0*N:xl*cos(5.0*N:xl^2 - 2*z) + 0.9

ddy = -sin(N:yl)*sin(7*N:yl + 1.234)*cos(10*z) + 7*cos(N:yl)*cos(10*z)*cos(7*N:yl + 1.234)

source = 20.0*N:xl^2*sin(5.0*N:xl^2 - 2*z) + 2.0*(7*sin(N:yl)*cos(7*N:yl + 1.234) + 25*sin(7*N:yl + 1.234)*cos(N:yl))*cos(10*z) + 0.8*sin(5.0*N:xl^2 - 2*z) + 100.0*sin(7*N:yl + 1.234)*cos(N:yl)*cos(10*z) - 2.0*cos(5.0*N:xl^2 - 2*z)

bndry_all = dirichlet_o2(N:solution)
